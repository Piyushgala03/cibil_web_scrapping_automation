2025-11-02 17:26:34,358 - INFO - Logging initialized at: C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\utilities\logs\2025-11-02\cibil_log_2025-11-02_17-26-34.log
2025-11-02 17:26:34,359 - INFO - ▶ Running script...
2025-11-02 17:26:34,359 - INFO - Running script...
2025-11-02 17:26:34,361 - INFO - Selected Configurations: 
state type: state, 
Defaulters type: >25 lacs, 
Date: 31-08-25, 
Timeout: 60 seconds
2025-11-02 17:26:34,361 - INFO - All States: {'JAKARTA', 'UNITED ARAB EMIRATES UAE', 'AUSTRALIA', 'PANAMA', 'ISRAEL', 'AMSTERDAM', 'SOUTH AFRICA', 'ATLANTA, USA', 'GUJARAT', 'CHANDIGARH (U.T.) & DELHI', 'ORISSA', 'UTAH', 'COLOMBO', 'DADRA AND NAGAR HAVELI', 'CHHATTISGARH', 'UNITED ARAB EMIRATES', 'SRI LANKA', 'NEW YORK', 'ASSAM', 'UTTAR PRADESH', 'DELHI', 'ARUNACHAL PRADESH', 'KERALA', 'NEW DELHI', 'HONG KONG', 'KARNATAKA', 'BRITISH VIRGIN ISLAND', 'BANGKOK', 'ROHTAK', 'UNITED STATES OF AMERICA', 'MANIPUR', 'HYDERABAD', 'MADHYA PRADESH', 'JAMMU & KASHMIR', 'JAPAN', 'QATAR', 'OVERSEAS', 'DAMAN AND DIU', 'WASHINGTON', 'CHANDIGARH & DELHI', 'MAHARASHTRA', 'LONDON', 'PUDUCHERRY', 'CHANDIGARH', 'ANDAMAN AND NICOBAR ISLANDS', 'NAGALAND', 'PONDICHERRY', 'OMAN', 'THAILAND', 'MALDIVES', 'TELANGANA', 'CYPRUS', 'ANDHRA PRADESH', 'LUXEMBOURG', 'ENGLAND', 'UTTARAKHAND', 'WEST BENGAL', 'BANGLADESH', 'JHARKHAND', 'UNITED KINGDOM', 'DUBAI, UAE', 'GERMANY', 'MISSISSIPPI, USA', 'SIKKIM', 'BAHRAIN', 'MEGHALAYA', 'GOA', 'PUNJAB', 'ABCD', 'HIMACHAL PRADESH', 'RAJASTHAN', 'DUBAI', 'SINGAPORE', 'TRIPURA', 'NOT REPORTED', 'MANCHESTER', 'KINGDOM OF BAHRAIN', 'BIHAR', 'LAKSHADWEEP', 'MIZORAM', 'HARYANA', 'BHOPAL', 'BELGIUM', 'CAYMAN ISLAND', 'OBU', 'UTTARANCHAL', 'TAMIL NADU'}
2025-11-02 17:26:34,362 - INFO - Selected States: ['BIHAR', 'GOA', 'GUJARAT', 'MAHARASHTRA']
2025-11-02 17:26:34,362 - INFO - ▶ Starting batch search for date: 31-08-25
2025-11-02 17:26:34,362 - INFO - Running automation for State: BIHAR, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 17:26:35,382 - INFO - Browser launched.
2025-11-02 17:26:36,352 - INFO - Page loaded.
2025-11-02 17:26:36,353 - INFO - ▶ Performing search for date:31-08-25, state:BIHAR, Defaulters type:>25 lacs
2025-11-02 17:26:38,481 - INFO - ▶ Waiting for search results...
2025-11-02 17:26:46,015 - INFO - Pagination text: View 1 - 125 of 125
2025-11-02 17:26:46,016 - INFO - Fetched: 125, Total: 125
2025-11-02 17:26:46,016 - INFO - ▶ Fetched 125 out of 125 rows.
2025-11-02 17:26:46,016 - INFO - Pagination limit: 1
2025-11-02 17:26:46,016 - INFO - Raw Data for BIHAR already exists. Skipping raw table extraction.
2025-11-02 17:26:46,017 - INFO - Found 1 raw Excel files for BIHAR
2025-11-02 17:26:46,240 - INFO - Directors already extracted for row 1, skipping...
2025-11-02 17:26:46,241 - INFO - Directors already extracted for row 2, skipping...
2025-11-02 17:26:46,241 - INFO - Directors already extracted for row 3, skipping...
2025-11-02 17:26:46,255 - INFO - ✅ Updated raw file saved with director info → C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_BIHAR_state_page_1.xlsx
2025-11-02 17:26:46,510 - INFO - Running automation for State: GOA, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 17:26:47,331 - INFO - Browser launched.
2025-11-02 17:26:48,368 - INFO - Page loaded.
2025-11-02 17:26:48,368 - INFO - ▶ Performing search for date:31-08-25, state:GOA, Defaulters type:>25 lacs
2025-11-02 17:26:50,951 - INFO - ▶ Waiting for search results...
2025-11-02 17:26:58,469 - INFO - Pagination text: View 1 - 25 of 25
2025-11-02 17:26:58,470 - INFO - Fetched: 25, Total: 25
2025-11-02 17:26:58,470 - INFO - ▶ Fetched 25 out of 25 rows.
2025-11-02 17:26:58,470 - INFO - Pagination limit: 1
2025-11-02 17:26:58,470 - INFO - Raw Data for GOA already exists. Skipping raw table extraction.
2025-11-02 17:26:58,471 - INFO - Found 1 raw Excel files for GOA
2025-11-02 17:26:58,489 - INFO - Directors already extracted for row 1, skipping...
2025-11-02 17:26:58,490 - INFO - Directors already extracted for row 2, skipping...
2025-11-02 17:26:58,490 - INFO - Directors already extracted for row 3, skipping...
2025-11-02 17:26:58,499 - INFO - ✅ Updated raw file saved with director info → C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_GOA_state_page_1.xlsx
2025-11-02 17:26:58,724 - INFO - Running automation for State: GUJARAT, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 17:26:59,520 - INFO - Browser launched.
2025-11-02 17:27:00,518 - INFO - Page loaded.
2025-11-02 17:27:00,518 - INFO - ▶ Performing search for date:31-08-25, state:GUJARAT, Defaulters type:>25 lacs
2025-11-02 17:27:03,167 - INFO - ▶ Waiting for search results...
2025-11-02 17:27:10,614 - INFO - Pagination text: View 1 - 1,000 of 1,233
2025-11-02 17:27:10,614 - INFO - Fetched: 1000, Total: 1233
2025-11-02 17:27:10,614 - INFO - ▶ Fetched 1000 out of 1233 rows.
2025-11-02 17:27:10,615 - INFO - Pagination limit: 2
2025-11-02 17:27:10,615 - INFO - Raw Data for GUJARAT already exists. Skipping raw table extraction.
2025-11-02 17:27:10,615 - INFO - Found 2 raw Excel files for GUJARAT
2025-11-02 17:27:10,635 - INFO - Directors already extracted for row 1, skipping...
2025-11-02 17:27:10,635 - INFO - Directors already extracted for row 2, skipping...
2025-11-02 17:27:10,635 - INFO - Directors already extracted for row 3, skipping...
2025-11-02 17:27:10,644 - INFO - ✅ Updated raw file saved with director info → C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_GUJARAT_state_page_1.xlsx
2025-11-02 17:27:10,663 - INFO - Directors already extracted for row 1, skipping...
2025-11-02 17:27:10,663 - INFO - Directors already extracted for row 2, skipping...
2025-11-02 17:27:10,663 - INFO - Directors already extracted for row 3, skipping...
2025-11-02 17:27:10,673 - INFO - ✅ Updated raw file saved with director info → C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_GUJARAT_state_page_2.xlsx
2025-11-02 17:27:10,926 - INFO - Running automation for State: MAHARASHTRA, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 17:27:11,726 - INFO - Browser launched.
2025-11-02 17:27:12,705 - INFO - Page loaded.
2025-11-02 17:27:12,705 - INFO - ▶ Performing search for date:31-08-25, state:MAHARASHTRA, Defaulters type:>25 lacs
2025-11-02 17:27:15,418 - INFO - ▶ Waiting for search results...
2025-11-02 17:27:22,956 - INFO - Pagination text: View 1 - 1,000 of 3,659
2025-11-02 17:27:22,957 - INFO - Fetched: 1000, Total: 3659
2025-11-02 17:27:22,957 - INFO - ▶ Fetched 1000 out of 3659 rows.
2025-11-02 17:27:22,957 - INFO - Pagination limit: 4
2025-11-02 17:27:22,957 - INFO - ▶ Extracting table data...
2025-11-02 17:27:22,987 - INFO - Found 1000 rows for state: MAHARASHTRA, page: 1.
2025-11-02 17:27:23,306 - INFO - Row 1/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:23,575 - INFO - Row 2/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:23,831 - INFO - Row 3/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:23,864 - INFO - Saved 3 rows to cibil_data_31-08-25_MAHARASHTRA_state_page_1.xlsx
2025-11-02 17:27:27,154 - INFO - ▶ Extracting table data...
2025-11-02 17:27:27,178 - INFO - Found 1000 rows for state: MAHARASHTRA, page: 2.
2025-11-02 17:27:27,459 - INFO - Row 1/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:27,757 - INFO - Row 2/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:28,022 - INFO - Row 3/1000 extracted for MAHARASHTRA.
2025-11-02 17:27:28,054 - INFO - Saved 3 rows to cibil_data_31-08-25_MAHARASHTRA_state_page_2.xlsx
2025-11-02 17:27:31,329 - INFO - ▶ Extracting table data...
2025-11-02 17:27:31,343 - ERROR - ⚠️ No data or error extracting table for MAHARASHTRA: Page.wait_for_selector: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\utilities\extract_table_data.py", line 7, in extract_table_data
    page.wait_for_selector("table.ui-jqgrid-btable tr.jqgrow", timeout=timeout_ms)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\sync_api\_generated.py", line 8182, in wait_for_selector
    self._sync(
    ~~~~~~~~~~^
        self._impl_obj.wait_for_selector(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            selector=selector, timeout=timeout, state=state, strict=strict
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_sync_base.py", line 115, in _sync
    return task.result()
           ~~~~~~~~~~~^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_page.py", line 423, in wait_for_selector
    return await self._main_frame.wait_for_selector(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_frame.py", line 369, in wait_for_selector
    await self._channel.send(
        "waitForSelector", self._timeout, locals_to_params(locals())
    )
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Page.wait_for_selector: Target page, context or browser has been closed
2025-11-02 17:27:31,348 - ERROR - ❌ Failed to capture screenshot: Page.screenshot: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\utilities\extract_table_data.py", line 17, in extract_table_data
    page.screenshot(path=screenshot_path, full_page=True)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\sync_api\_generated.py", line 9784, in screenshot
    self._sync(
    ~~~~~~~~~~^
        self._impl_obj.screenshot(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        )
        ^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_sync_base.py", line 115, in _sync
    return task.result()
           ~~~~~~~~~~~^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_page.py", line 818, in screenshot
    encoded_binary = await self._channel.send(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
        "screenshot", self._timeout_settings.timeout, params
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Page.screenshot: Target page, context or browser has been closed
2025-11-02 17:27:31,541 - ERROR - ❌ Error for MAHARASHTRA: 'tuple' object has no attribute 'empty'
