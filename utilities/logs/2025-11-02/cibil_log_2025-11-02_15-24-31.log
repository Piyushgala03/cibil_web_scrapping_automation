2025-11-02 15:24:31,562 - INFO - Running script...
2025-11-02 15:24:31,580 - INFO - Selected Configurations: 
state type: state, 
Defaulters type: >25 lacs, 
Date: 31-08-25, 
Timeout: 60 seconds
2025-11-02 15:24:31,580 - INFO - All States: {'ANDAMAN AND NICOBAR ISLANDS', 'KERALA', 'JHARKHAND', 'MALDIVES', 'HONG KONG', 'GOA', 'ISRAEL', 'SRI LANKA', 'UTTARAKHAND', 'NEW DELHI', 'AUSTRALIA', 'MAHARASHTRA', 'CHANDIGARH & DELHI', 'MADHYA PRADESH', 'UTTAR PRADESH', 'LUXEMBOURG', 'MANCHESTER', 'SOUTH AFRICA', 'ABCD', 'UNITED ARAB EMIRATES', 'BELGIUM', 'OMAN', 'NAGALAND', 'GUJARAT', 'DUBAI, UAE', 'OVERSEAS', 'SINGAPORE', 'MANIPUR', 'BRITISH VIRGIN ISLAND', 'CHANDIGARH (U.T.) & DELHI', 'PANAMA', 'PUNJAB', 'JAMMU & KASHMIR', 'HYDERABAD', 'MIZORAM', 'HIMACHAL PRADESH', 'RAJASTHAN', 'TELANGANA', 'UNITED ARAB EMIRATES UAE', 'BHOPAL', 'MEGHALAYA', 'PONDICHERRY', 'CYPRUS', 'LONDON', 'JAPAN', 'HARYANA', 'NOT REPORTED', 'JAKARTA', 'OBU', 'AMSTERDAM', 'COLOMBO', 'ASSAM', 'TRIPURA', 'ORISSA', 'BAHRAIN', 'THAILAND', 'WASHINGTON', 'BIHAR', 'CHHATTISGARH', 'BANGLADESH', 'ATLANTA, USA', 'UTTARANCHAL', 'BANGKOK', 'ANDHRA PRADESH', 'KARNATAKA', 'ARUNACHAL PRADESH', 'MISSISSIPPI, USA', 'UNITED STATES OF AMERICA', 'SIKKIM', 'LAKSHADWEEP', 'NEW YORK', 'ROHTAK', 'TAMIL NADU', 'QATAR', 'PUDUCHERRY', 'DELHI', 'DAMAN AND DIU', 'CHANDIGARH', 'CAYMAN ISLAND', 'DUBAI', 'UTAH', 'DADRA AND NAGAR HAVELI', 'WEST BENGAL', 'KINGDOM OF BAHRAIN', 'UNITED KINGDOM', 'ENGLAND', 'GERMANY'}
2025-11-02 15:24:31,580 - INFO - Selected States: ['ANDAMAN AND NICOBAR ISLANDS', 'ARUNACHAL PRADESH', 'GOA', 'GUJARAT']
2025-11-02 15:24:31,581 - INFO - Starting batch search for date: 31-08-25
2025-11-02 15:24:31,582 - INFO - Running automation for State: ANDAMAN AND NICOBAR ISLANDS, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 15:24:31,582 - DEBUG - Using proactor: IocpProactor
2025-11-02 15:24:33,282 - INFO - Browser launched.
2025-11-02 15:24:34,705 - INFO - Page loaded.
2025-11-02 15:24:34,706 - INFO - Performing search for date:31-08-25, state:ANDAMAN AND NICOBAR ISLANDS, Defaulters type:>25 lacs
2025-11-02 15:24:37,963 - INFO - Waiting for search results...
2025-11-02 15:24:37,990 - INFO - Loader disappeared after clicking Search.
2025-11-02 15:24:45,597 - INFO - Pagination text: View 1 - 2 of 2
2025-11-02 15:24:45,597 - INFO - Fetched: 2, Total: 2
2025-11-02 15:24:45,598 - INFO - Fetched 2 out of 2 rows.
2025-11-02 15:24:45,598 - INFO - Pagination limit: 1
2025-11-02 15:24:45,598 - INFO - Raw Data for ANDAMAN AND NICOBAR ISLANDS already exists. Skipping raw table extraction.
2025-11-02 15:24:46,100 - INFO - \u2705 Updated raw file saved with director info \u2192 C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_ANDAMAN AND NICOBAR ISLANDS_state_page_1_20251102_151517.xlsx
2025-11-02 15:24:46,653 - INFO - Running automation for State: ARUNACHAL PRADESH, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 15:24:46,653 - DEBUG - Using proactor: IocpProactor
2025-11-02 15:24:48,384 - INFO - Browser launched.
2025-11-02 15:24:49,558 - INFO - Page loaded.
2025-11-02 15:24:49,558 - INFO - Performing search for date:31-08-25, state:ARUNACHAL PRADESH, Defaulters type:>25 lacs
2025-11-02 15:24:52,872 - INFO - Waiting for search results...
2025-11-02 15:24:52,909 - INFO - Loader disappeared after clicking Search.
2025-11-02 15:25:00,390 - INFO - Pagination text: View 1 - 6 of 6
2025-11-02 15:25:00,390 - INFO - Fetched: 6, Total: 6
2025-11-02 15:25:00,390 - INFO - Fetched 6 out of 6 rows.
2025-11-02 15:25:00,391 - INFO - Pagination limit: 1
2025-11-02 15:25:00,391 - INFO - Raw Data for ARUNACHAL PRADESH already exists. Skipping raw table extraction.
2025-11-02 15:25:00,458 - INFO - \u2705 Updated raw file saved with director info \u2192 C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_ARUNACHAL PRADESH_state_page_1_20251102_151551.xlsx
2025-11-02 15:25:01,075 - INFO - Running automation for State: GOA, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 15:25:01,076 - DEBUG - Using proactor: IocpProactor
2025-11-02 15:25:03,056 - INFO - Browser launched.
2025-11-02 15:25:08,440 - INFO - Page loaded.
2025-11-02 15:25:08,440 - INFO - Performing search for date:31-08-25, state:GOA, Defaulters type:>25 lacs
2025-11-02 15:25:15,618 - INFO - Waiting for search results...
2025-11-02 15:25:15,656 - INFO - Loader disappeared after clicking Search.
2025-11-02 15:25:24,317 - INFO - Pagination text: View 1 - 25 of 25
2025-11-02 15:25:24,317 - INFO - Fetched: 25, Total: 25
2025-11-02 15:25:24,318 - INFO - Fetched 25 out of 25 rows.
2025-11-02 15:25:24,318 - INFO - Pagination limit: 1
2025-11-02 15:25:24,319 - INFO - Raw Data for GOA already exists. Skipping raw table extraction.
2025-11-02 15:25:24,376 - INFO - \u2705 Updated raw file saved with director info \u2192 C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw\cibil_data__25_lacs_31-08-25_for_state\cibil_data_31-08-25_GOA_state_page_1_20251102_151657.xlsx
2025-11-02 15:25:24,854 - INFO - Running automation for State: GUJARAT, Date: 31-08-25, Defaulters type: >25 lacs
2025-11-02 15:25:24,855 - DEBUG - Using proactor: IocpProactor
2025-11-02 15:25:26,655 - INFO - Browser launched.
2025-11-02 15:25:28,206 - INFO - Page loaded.
2025-11-02 15:25:28,207 - INFO - Performing search for date:31-08-25, state:GUJARAT, Defaulters type:>25 lacs
2025-11-02 15:25:32,110 - INFO - Waiting for search results...
2025-11-02 15:25:32,138 - INFO - Loader disappeared after clicking Search.
2025-11-02 15:25:40,912 - INFO - Pagination text: View 1 - 1,000 of 1,233
2025-11-02 15:25:40,912 - INFO - Fetched: 1000, Total: 1233
2025-11-02 15:25:40,913 - INFO - Fetched 1000 out of 1233 rows.
2025-11-02 15:25:40,913 - INFO - Pagination limit: 2
2025-11-02 15:25:40,914 - INFO - \u25b6 Extracting table data...
2025-11-02 15:25:40,955 - INFO - Found 1000 rows for state: GUJARAT, page: 1.
2025-11-02 15:25:41,675 - INFO - Row 1/1000 extracted for GUJARAT.
2025-11-02 15:25:42,299 - INFO - Row 2/1000 extracted for GUJARAT.
2025-11-02 15:25:42,874 - INFO - Row 3/1000 extracted for GUJARAT.
2025-11-02 15:25:42,928 - INFO - Saved 3 rows to cibil_data_31-08-25_GUJARAT_state_page_1_20251102_152542.xlsx
2025-11-02 15:25:48,307 - INFO - \u25b6 Extracting table data...
2025-11-02 15:25:48,311 - ERROR - No data or error extracting table for GUJARAT: Page.wait_for_selector: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\utilities\extract_table_data.py", line 8, in extract_table_data
    page.wait_for_selector("table.ui-jqgrid-btable tr.jqgrow", timeout=timeout_ms)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\sync_api\_generated.py", line 8182, in wait_for_selector
    self._sync(
    ~~~~~~~~~~^
        self._impl_obj.wait_for_selector(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            selector=selector, timeout=timeout, state=state, strict=strict
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_sync_base.py", line 115, in _sync
    return task.result()
           ~~~~~~~~~~~^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_page.py", line 423, in wait_for_selector
    return await self._main_frame.wait_for_selector(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_frame.py", line 369, in wait_for_selector
    await self._channel.send(
        "waitForSelector", self._timeout, locals_to_params(locals())
    )
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Page.wait_for_selector: Target page, context or browser has been closed
2025-11-02 15:25:48,323 - ERROR - Failed to capture screenshot: Page.screenshot: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\utilities\extract_table_data.py", line 19, in extract_table_data
    page.screenshot(path=screenshot_path, full_page=True)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\sync_api\_generated.py", line 9784, in screenshot
    self._sync(
    ~~~~~~~~~~^
        self._impl_obj.screenshot(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<13 lines>...
        )
        ^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_sync_base.py", line 115, in _sync
    return task.result()
           ~~~~~~~~~~~^^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_page.py", line 818, in screenshot
    encoded_binary = await self._channel.send(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
        "screenshot", self._timeout_settings.timeout, params
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\.venv\Lib\site-packages\playwright\_impl\_connection.py", line 558, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Page.screenshot: Target page, context or browser has been closed
2025-11-02 15:25:48,771 - ERROR - Error for GUJARAT: 'tuple' object has no attribute 'empty'
2025-11-02 15:25:48,771 - INFO - Current working folder: C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\raw
2025-11-02 15:25:48,772 - INFO - Folders found for processing: []
2025-11-02 15:25:48,774 - INFO - All states loaded successfully: 87 states found.
2025-11-02 15:25:48,774 - INFO - State-Date wise file mapping created with 0 keys.
2025-11-02 15:25:48,775 - INFO - Current folder path: C:\Users\piyush gala\PC\Portfolio\cibil_web_scrapping_automation\fetched_data\final
2025-11-02 15:25:48,776 - INFO - Folders found for processing: []
